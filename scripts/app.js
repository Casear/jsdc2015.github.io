$(document).ready(function(){var s=2500,e=3800,a=e-3e3,n=50,t=150,d=500,l=d+800,r=600,o=1500,c=function(s){s.each(function(){var s=$(this),e=s.text().split(""),a=s.hasClass("is-visible");for(i in e)s.parents(".rotate-2").length>0&&(e[i]="<em>"+e[i]+"</em>"),e[i]=a?'<i class="in">'+e[i]+"</i>":"<i>"+e[i]+"</i>";var n=e.join("");s.html(n).css("opacity",1)})},h=function(i){var n=s;i.each(function(){var s=$(this);if(s.hasClass("loading-bar"))n=e,setTimeout(function(){s.find(".cd-words-wrapper").addClass("is-loading")},a);else if(s.hasClass("clip")){var i=s.find(".cd-words-wrapper"),t=i.width()+10;i.css("width",t)}else if(!s.hasClass("type")){var d=s.find(".cd-words-wrapper b"),l=0;d.each(function(){var s=$(this).width();s>l&&(l=s)}),s.find(".cd-words-wrapper").css("width",l)}setTimeout(function(){u(s.find(".is-visible").eq(0))},n)})},u=function(i){var o=C(i);if(i.parents(".cd-headline").hasClass("type")){var c=i.parent(".cd-words-wrapper");c.addClass("selected").removeClass("waiting"),setTimeout(function(){c.removeClass("selected"),i.removeClass("is-visible").addClass("is-hidden").children("i").removeClass("in").addClass("out")},d),setTimeout(function(){p(o,t)},l)}else if(i.parents(".cd-headline").hasClass("letters")){var h=i.children("i").length>=o.children("i").length?!0:!1;f(i.find("i").eq(0),i,h,n),m(o.find("i").eq(0),o,h,n)}else i.parents(".cd-headline").hasClass("clip")?i.parents(".cd-words-wrapper").animate({width:"2px"},r,function(){v(i,o),p(o)}):i.parents(".cd-headline").hasClass("loading-bar")?(i.parents(".cd-words-wrapper").removeClass("is-loading"),v(i,o),setTimeout(function(){u(o)},e),setTimeout(function(){i.parents(".cd-words-wrapper").addClass("is-loading")},a)):(v(i,o),setTimeout(function(){u(o)},s))},p=function(s,e){s.parents(".cd-headline").hasClass("type")?(m(s.find("i").eq(0),s,!1,e),s.addClass("is-visible").removeClass("is-hidden")):s.parents(".cd-headline").hasClass("clip")&&s.parents(".cd-words-wrapper").animate({width:s.width()+10},r,function(){setTimeout(function(){u(s)},o)})},f=function(e,i,a,n){if(e.removeClass("in").addClass("out"),e.is(":last-child")?a&&setTimeout(function(){u(C(i))},s):setTimeout(function(){f(e.next(),i,a,n)},n),e.is(":last-child")&&$("html").hasClass("no-csstransitions")){var t=C(i);v(i,t)}},m=function(e,i,a,n){e.addClass("in").removeClass("out"),e.is(":last-child")?(i.parents(".cd-headline").hasClass("type")&&setTimeout(function(){i.parents(".cd-words-wrapper").addClass("waiting")},200),a||setTimeout(function(){u(i)},s)):setTimeout(function(){m(e.next(),i,a,n)},n)},C=function(s){return s.is(":last-child")?s.parent().children().eq(0):s.next()},v=function(s,e){s.removeClass("is-visible").addClass("is-hidden"),e.removeClass("is-hidden").addClass("is-visible")},w=function(){c($(".cd-headline.letters").find("b")),h($(".cd-headline"))};w();var T=document.getElementsByTagName("video")[0];document.body.addEventListener("touchstart",function(){T.play()},!1)});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiJCIsImRvY3VtZW50IiwicmVhZHkiLCJhbmltYXRpb25EZWxheSIsImJhckFuaW1hdGlvbkRlbGF5IiwiYmFyV2FpdGluZyIsImxldHRlcnNEZWxheSIsInR5cGVMZXR0ZXJzRGVsYXkiLCJzZWxlY3Rpb25EdXJhdGlvbiIsInR5cGVBbmltYXRpb25EZWxheSIsInJldmVhbER1cmF0aW9uIiwicmV2ZWFsQW5pbWF0aW9uRGVsYXkiLCJzaW5nbGVMZXR0ZXJzIiwiJHdvcmRzIiwiZWFjaCIsIndvcmQiLCJ0aGlzIiwibGV0dGVycyIsInRleHQiLCJzcGxpdCIsInNlbGVjdGVkIiwiaGFzQ2xhc3MiLCJpIiwicGFyZW50cyIsImxlbmd0aCIsIm5ld0xldHRlcnMiLCJqb2luIiwiaHRtbCIsImNzcyIsImFuaW1hdGVIZWFkbGluZSIsIiRoZWFkbGluZXMiLCJkdXJhdGlvbiIsImhlYWRsaW5lIiwic2V0VGltZW91dCIsImZpbmQiLCJhZGRDbGFzcyIsInNwYW5XcmFwcGVyIiwibmV3V2lkdGgiLCJ3aWR0aCIsIndvcmRzIiwid29yZFdpZHRoIiwiaGlkZVdvcmQiLCJlcSIsIiR3b3JkIiwibmV4dFdvcmQiLCJ0YWtlTmV4dCIsInBhcmVudFNwYW4iLCJwYXJlbnQiLCJyZW1vdmVDbGFzcyIsImNoaWxkcmVuIiwic2hvd1dvcmQiLCJib29sIiwiaGlkZUxldHRlciIsInNob3dMZXR0ZXIiLCJhbmltYXRlIiwic3dpdGNoV29yZCIsIiRkdXJhdGlvbiIsIiRsZXR0ZXIiLCIkYm9vbCIsImlzIiwibmV4dCIsIiRvbGRXb3JkIiwiJG5ld1dvcmQiLCJpbml0SGVhZGxpbmUiLCJ2aWRlbyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYm9keSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwbGF5Il0sIm1hcHBpbmdzIjoiQUFBQUEsRUFBQUMsVUFBQUMsTUFBQSxXQUVBLEdBQUFDLEdBQUEsS0FFQUMsRUFBQSxLQUNBQyxFQUFBRCxFQUFB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QixFQUFBLGlCQUdBK0QsSUFFQSxJQUFBQyxHQUFBL0QsU0FBQWdFLHFCQUFBLFNBQUEsRUFDQWhFLFVBQUFpRSxLQUFBQyxpQkFBQSxhQUFBLFdBQ0FILEVBQUFJLFNBQ0EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gIC8vc2V0IGFuaW1hdGlvbiB0aW1pbmdcbiAgdmFyIGFuaW1hdGlvbkRlbGF5ID0gMjUwMCxcbiAgICAvL2xvYWRpbmcgYmFyIGVmZmVjdFxuICAgIGJhckFuaW1hdGlvbkRlbGF5ID0gMzgwMCxcbiAgICBiYXJXYWl0aW5nID0gYmFyQW5pbWF0aW9uRGVsYXkgLSAzMDAwLCAvLzMwMDAgaXMgdGhlIGR1cmF0aW9uIG9mIHRoZSB0cmFuc2l0aW9uIG9uIHRoZSBsb2FkaW5nIGJhciAtIHNldCBpbiB0aGUgc2Nzcy9jc3MgZmlsZVxuICAgIC8vbGV0dGVycyBlZmZlY3RcbiAgICBsZXR0ZXJzRGVsYXkgPSA1MCxcbiAgICAvL3R5cGUgZWZmZWN0XG4gICAgdHlwZUxldHRlcnNEZWxheSA9IDE1MCxcbiAgICBzZWxlY3Rpb25EdXJhdGlvbiA9IDUwMCxcbiAgICB0eXBlQW5pbWF0aW9uRGVsYXkgPSBzZWxlY3Rpb25EdXJhdGlvbiArIDgwMCxcbiAgICAvL2NsaXAgZWZmZWN0IFxuICAgIHJldmVhbER1cmF0aW9uID0gNjAwLFxuICAgIHJldmVhbEFuaW1hdGlvbkRlbGF5ID0gMTUwMDtcblxuICB2YXIgc2luZ2xlTGV0dGVycyA9IGZ1bmN0aW9uKCR3b3Jkcykge1xuICAgICR3b3Jkcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHdvcmQgPSAkKHRoaXMpLFxuICAgICAgICBsZXR0ZXJzID0gd29yZC50ZXh0KCkuc3BsaXQoJycpLFxuICAgICAgICBzZWxlY3RlZCA9IHdvcmQuaGFzQ2xhc3MoJ2lzLXZpc2libGUnKTtcbiAgICAgIGZvciAoaSBpbiBsZXR0ZXJzKSB7XG4gICAgICAgIGlmICh3b3JkLnBhcmVudHMoJy5yb3RhdGUtMicpLmxlbmd0aCA+IDApIGxldHRlcnNbaV0gPSAnPGVtPicgKyBsZXR0ZXJzW2ldICsgJzwvZW0+JztcbiAgICAgICAgbGV0dGVyc1tpXSA9IChzZWxlY3RlZCkgPyAnPGkgY2xhc3M9XCJpblwiPicgKyBsZXR0ZXJzW2ldICsgJzwvaT4nIDogJzxpPicgKyBsZXR0ZXJzW2ldICsgJzwvaT4nO1xuICAgICAgfVxuICAgICAgdmFyIG5ld0xldHRlcnMgPSBsZXR0ZXJzLmpvaW4oJycpO1xuICAgICAgd29yZC5odG1sKG5ld0xldHRlcnMpLmNzcygnb3BhY2l0eScsIDEpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBhbmltYXRlSGVhZGxpbmUgPSBmdW5jdGlvbigkaGVhZGxpbmVzKSB7XG4gICAgdmFyIGR1cmF0aW9uID0gYW5pbWF0aW9uRGVsYXk7XG4gICAgJGhlYWRsaW5lcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGhlYWRsaW5lID0gJCh0aGlzKTtcblxuICAgICAgaWYgKGhlYWRsaW5lLmhhc0NsYXNzKCdsb2FkaW5nLWJhcicpKSB7XG4gICAgICAgIGR1cmF0aW9uID0gYmFyQW5pbWF0aW9uRGVsYXk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaGVhZGxpbmUuZmluZCgnLmNkLXdvcmRzLXdyYXBwZXInKS5hZGRDbGFzcygnaXMtbG9hZGluZycpXG4gICAgICAgIH0sIGJhcldhaXRpbmcpO1xuICAgICAgfSBlbHNlIGlmIChoZWFkbGluZS5oYXNDbGFzcygnY2xpcCcpKSB7XG4gICAgICAgIHZhciBzcGFuV3JhcHBlciA9IGhlYWRsaW5lLmZpbmQoJy5jZC13b3Jkcy13cmFwcGVyJyksXG4gICAgICAgICAgbmV3V2lkdGggPSBzcGFuV3JhcHBlci53aWR0aCgpICsgMTBcbiAgICAgICAgc3BhbldyYXBwZXIuY3NzKCd3aWR0aCcsIG5ld1dpZHRoKTtcbiAgICAgIH0gZWxzZSBpZiAoIWhlYWRsaW5lLmhhc0NsYXNzKCd0eXBlJykpIHtcbiAgICAgICAgLy9hc3NpZ24gdG8gLmNkLXdvcmRzLXdyYXBwZXIgdGhlIHdpZHRoIG9mIGl0cyBsb25nZXN0IHdvcmRcbiAgICAgICAgdmFyIHdvcmRzID0gaGVhZGxpbmUuZmluZCgnLmNkLXdvcmRzLXdyYXBwZXIgYicpLFxuICAgICAgICAgIHdpZHRoID0gMDtcbiAgICAgICAgd29yZHMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgd29yZFdpZHRoID0gJCh0aGlzKS53aWR0aCgpO1xuICAgICAgICAgIGlmICh3b3JkV2lkdGggPiB3aWR0aCkgd2lkdGggPSB3b3JkV2lkdGg7XG4gICAgICAgIH0pO1xuICAgICAgICBoZWFkbGluZS5maW5kKCcuY2Qtd29yZHMtd3JhcHBlcicpLmNzcygnd2lkdGgnLCB3aWR0aCk7XG4gICAgICB9O1xuXG4gICAgICAvL3RyaWdnZXIgYW5pbWF0aW9uXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBoaWRlV29yZChoZWFkbGluZS5maW5kKCcuaXMtdmlzaWJsZScpLmVxKDApKVxuICAgICAgfSwgZHVyYXRpb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBoaWRlV29yZCA9IGZ1bmN0aW9uKCR3b3JkKSB7XG4gICAgdmFyIG5leHRXb3JkID0gdGFrZU5leHQoJHdvcmQpO1xuXG4gICAgaWYgKCR3b3JkLnBhcmVudHMoJy5jZC1oZWFkbGluZScpLmhhc0NsYXNzKCd0eXBlJykpIHtcbiAgICAgIHZhciBwYXJlbnRTcGFuID0gJHdvcmQucGFyZW50KCcuY2Qtd29yZHMtd3JhcHBlcicpO1xuICAgICAgcGFyZW50U3Bhbi5hZGRDbGFzcygnc2VsZWN0ZWQnKS5yZW1vdmVDbGFzcygnd2FpdGluZycpO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgcGFyZW50U3Bhbi5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgICAgJHdvcmQucmVtb3ZlQ2xhc3MoJ2lzLXZpc2libGUnKS5hZGRDbGFzcygnaXMtaGlkZGVuJykuY2hpbGRyZW4oJ2knKS5yZW1vdmVDbGFzcygnaW4nKS5hZGRDbGFzcygnb3V0Jyk7XG4gICAgICB9LCBzZWxlY3Rpb25EdXJhdGlvbik7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBzaG93V29yZChuZXh0V29yZCwgdHlwZUxldHRlcnNEZWxheSlcbiAgICAgIH0sIHR5cGVBbmltYXRpb25EZWxheSk7XG5cbiAgICB9IGVsc2UgaWYgKCR3b3JkLnBhcmVudHMoJy5jZC1oZWFkbGluZScpLmhhc0NsYXNzKCdsZXR0ZXJzJykpIHtcbiAgICAgIHZhciBib29sID0gKCR3b3JkLmNoaWxkcmVuKCdpJykubGVuZ3RoID49IG5leHRXb3JkLmNoaWxkcmVuKCdpJykubGVuZ3RoKSA/IHRydWUgOiBmYWxzZTtcbiAgICAgIGhpZGVMZXR0ZXIoJHdvcmQuZmluZCgnaScpLmVxKDApLCAkd29yZCwgYm9vbCwgbGV0dGVyc0RlbGF5KTtcbiAgICAgIHNob3dMZXR0ZXIobmV4dFdvcmQuZmluZCgnaScpLmVxKDApLCBuZXh0V29yZCwgYm9vbCwgbGV0dGVyc0RlbGF5KTtcblxuICAgIH0gZWxzZSBpZiAoJHdvcmQucGFyZW50cygnLmNkLWhlYWRsaW5lJykuaGFzQ2xhc3MoJ2NsaXAnKSkge1xuICAgICAgJHdvcmQucGFyZW50cygnLmNkLXdvcmRzLXdyYXBwZXInKS5hbmltYXRlKHtcbiAgICAgICAgd2lkdGg6ICcycHgnXG4gICAgICB9LCByZXZlYWxEdXJhdGlvbiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHN3aXRjaFdvcmQoJHdvcmQsIG5leHRXb3JkKTtcbiAgICAgICAgc2hvd1dvcmQobmV4dFdvcmQpO1xuICAgICAgfSk7XG5cbiAgICB9IGVsc2UgaWYgKCR3b3JkLnBhcmVudHMoJy5jZC1oZWFkbGluZScpLmhhc0NsYXNzKCdsb2FkaW5nLWJhcicpKSB7XG4gICAgICAkd29yZC5wYXJlbnRzKCcuY2Qtd29yZHMtd3JhcHBlcicpLnJlbW92ZUNsYXNzKCdpcy1sb2FkaW5nJyk7XG4gICAgICBzd2l0Y2hXb3JkKCR3b3JkLCBuZXh0V29yZCk7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBoaWRlV29yZChuZXh0V29yZClcbiAgICAgIH0sIGJhckFuaW1hdGlvbkRlbGF5KTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICR3b3JkLnBhcmVudHMoJy5jZC13b3Jkcy13cmFwcGVyJykuYWRkQ2xhc3MoJ2lzLWxvYWRpbmcnKVxuICAgICAgfSwgYmFyV2FpdGluZyk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgc3dpdGNoV29yZCgkd29yZCwgbmV4dFdvcmQpO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgaGlkZVdvcmQobmV4dFdvcmQpXG4gICAgICB9LCBhbmltYXRpb25EZWxheSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzaG93V29yZCA9IGZ1bmN0aW9uKCR3b3JkLCAkZHVyYXRpb24pIHtcbiAgICBpZiAoJHdvcmQucGFyZW50cygnLmNkLWhlYWRsaW5lJykuaGFzQ2xhc3MoJ3R5cGUnKSkge1xuICAgICAgc2hvd0xldHRlcigkd29yZC5maW5kKCdpJykuZXEoMCksICR3b3JkLCBmYWxzZSwgJGR1cmF0aW9uKTtcbiAgICAgICR3b3JkLmFkZENsYXNzKCdpcy12aXNpYmxlJykucmVtb3ZlQ2xhc3MoJ2lzLWhpZGRlbicpO1xuXG4gICAgfSBlbHNlIGlmICgkd29yZC5wYXJlbnRzKCcuY2QtaGVhZGxpbmUnKS5oYXNDbGFzcygnY2xpcCcpKSB7XG4gICAgICAkd29yZC5wYXJlbnRzKCcuY2Qtd29yZHMtd3JhcHBlcicpLmFuaW1hdGUoe1xuICAgICAgICAnd2lkdGgnOiAkd29yZC53aWR0aCgpICsgMTBcbiAgICAgIH0sIHJldmVhbER1cmF0aW9uLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBoaWRlV29yZCgkd29yZClcbiAgICAgICAgfSwgcmV2ZWFsQW5pbWF0aW9uRGVsYXkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBoaWRlTGV0dGVyID0gZnVuY3Rpb24oJGxldHRlciwgJHdvcmQsICRib29sLCAkZHVyYXRpb24pIHtcbiAgICAkbGV0dGVyLnJlbW92ZUNsYXNzKCdpbicpLmFkZENsYXNzKCdvdXQnKTtcblxuICAgIGlmICghJGxldHRlci5pcygnOmxhc3QtY2hpbGQnKSkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgaGlkZUxldHRlcigkbGV0dGVyLm5leHQoKSwgJHdvcmQsICRib29sLCAkZHVyYXRpb24pO1xuICAgICAgfSwgJGR1cmF0aW9uKTtcbiAgICB9IGVsc2UgaWYgKCRib29sKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBoaWRlV29yZCh0YWtlTmV4dCgkd29yZCkpXG4gICAgICB9LCBhbmltYXRpb25EZWxheSk7XG4gICAgfVxuXG4gICAgaWYgKCRsZXR0ZXIuaXMoJzpsYXN0LWNoaWxkJykgJiYgJCgnaHRtbCcpLmhhc0NsYXNzKCduby1jc3N0cmFuc2l0aW9ucycpKSB7XG4gICAgICB2YXIgbmV4dFdvcmQgPSB0YWtlTmV4dCgkd29yZCk7XG4gICAgICBzd2l0Y2hXb3JkKCR3b3JkLCBuZXh0V29yZCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzaG93TGV0dGVyID0gZnVuY3Rpb24oJGxldHRlciwgJHdvcmQsICRib29sLCAkZHVyYXRpb24pIHtcbiAgICAkbGV0dGVyLmFkZENsYXNzKCdpbicpLnJlbW92ZUNsYXNzKCdvdXQnKTtcblxuICAgIGlmICghJGxldHRlci5pcygnOmxhc3QtY2hpbGQnKSkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgc2hvd0xldHRlcigkbGV0dGVyLm5leHQoKSwgJHdvcmQsICRib29sLCAkZHVyYXRpb24pO1xuICAgICAgfSwgJGR1cmF0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCR3b3JkLnBhcmVudHMoJy5jZC1oZWFkbGluZScpLmhhc0NsYXNzKCd0eXBlJykpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAkd29yZC5wYXJlbnRzKCcuY2Qtd29yZHMtd3JhcHBlcicpLmFkZENsYXNzKCd3YWl0aW5nJyk7XG4gICAgICAgIH0sIDIwMCk7XG4gICAgICB9XG4gICAgICBpZiAoISRib29sKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaGlkZVdvcmQoJHdvcmQpXG4gICAgICAgIH0sIGFuaW1hdGlvbkRlbGF5KVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgdGFrZU5leHQgPSBmdW5jdGlvbigkd29yZCkge1xuICAgIHJldHVybiAoISR3b3JkLmlzKCc6bGFzdC1jaGlsZCcpKSA/ICR3b3JkLm5leHQoKSA6ICR3b3JkLnBhcmVudCgpLmNoaWxkcmVuKCkuZXEoMCk7XG4gIH07XG5cbiAgdmFyIHRha2VQcmV2ID0gZnVuY3Rpb24oJHdvcmQpIHtcbiAgICByZXR1cm4gKCEkd29yZC5pcygnOmZpcnN0LWNoaWxkJykpID8gJHdvcmQucHJldigpIDogJHdvcmQucGFyZW50KCkuY2hpbGRyZW4oKS5sYXN0KCk7XG4gIH07XG5cbiAgdmFyIHN3aXRjaFdvcmQgPSBmdW5jdGlvbigkb2xkV29yZCwgJG5ld1dvcmQpIHtcbiAgICAkb2xkV29yZC5yZW1vdmVDbGFzcygnaXMtdmlzaWJsZScpLmFkZENsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAkbmV3V29yZC5yZW1vdmVDbGFzcygnaXMtaGlkZGVuJykuYWRkQ2xhc3MoJ2lzLXZpc2libGUnKTtcbiAgfTtcblxuICB2YXIgaW5pdEhlYWRsaW5lID0gZnVuY3Rpb24gKCkge1xuICAgIC8vaW5zZXJ0IDxpPiBlbGVtZW50IGZvciBlYWNoIGxldHRlciBvZiBhIGNoYW5naW5nIHdvcmRcbiAgICBzaW5nbGVMZXR0ZXJzKCQoJy5jZC1oZWFkbGluZS5sZXR0ZXJzJykuZmluZCgnYicpKTtcbiAgICAvL2luaXRpYWxpc2UgaGVhZGxpbmUgYW5pbWF0aW9uXG4gICAgYW5pbWF0ZUhlYWRsaW5lKCQoJy5jZC1oZWFkbGluZScpKTtcbiAgfTtcblxuICBpbml0SGVhZGxpbmUoKTtcblxuICB2YXIgdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndmlkZW8nKVswXTtcbiAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JyxmdW5jdGlvbigpe1xuICAgIHZpZGVvLnBsYXkoKTtcbiAgfSwgZmFsc2UpO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zcmMvc2NyaXB0cyJ9